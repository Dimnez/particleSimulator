var CE;CE=(()=>{"use strict";var t={132:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){}}},468:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=s(i(132)),n=s(i(274)),o=s(i(499)),r=s(i(327));e.default=class{constructor(t,e){const i=document.querySelector(t);this.configuration=new a.default,this.configuration.htmlCanvasElement=i,this.configuration.canvasWidth=i.clientWidth,this.configuration.canvasHeight=i.clientHeight,this.configuration.canvasElement2DContext=i.getContext("2d"),this.configuration.window=e,this.configuration.canvasElement2DContext.imageSmoothingEnabled=!1,this.controls=new n.default(this.configuration),this.draw=new o.default(this.configuration),this.loop=new r.default(this.configuration),this.initialize()}initialize(){this.controls.initialize()}}},274:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardKeys=void 0;const a=s(i(923));var n;(n=e.KeyboardKeys||(e.KeyboardKeys={}))[n.LEFT=39]="LEFT",n[n.RIGHT=37]="RIGHT",n[n.UP=38]="UP",n[n.DOWN=40]="DOWN",n[n.ENTER=13]="ENTER",n[n.SPACE=32]="SPACE",n[n.ESCAPE=27]="ESCAPE",n[n.SHIFT=16]="SHIFT";class o extends a.default{constructor(t){super(t),this.currentKeys=new Set,this.mouseState={clientX:0,clientY:0,mouseDown:!1},this.setEvents(t.window)}initialize(){this.initialized=!0}setEvents(t){t.addEventListener("keydown",this.keyDown.bind(this),!1),t.addEventListener("keyup",this.keyUp.bind(this),!1),t.addEventListener("mousemove",this.mousemove.bind(this),!1),t.addEventListener("mousedown",this.mousedown.bind(this),!1),t.addEventListener("mouseup",this.mouseup.bind(this),!1)}keyDown(t){this.currentKeys.add(t.code)}keyUp(t){this.currentKeys.delete(t.code)}mousemove(t){this.mouseState.clientX=t.clientX,this.mouseState.clientY=t.clientY}mousedown(t){this.mouseState.mouseDown=!0}mouseup(t){this.mouseState.mouseDown=!1}read(){return this.currentKeys}isPressed(t){return this.currentKeys.has(t.toString())}}e.default=o},499:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=s(i(923));class n extends a.default{initialize(){this.initialized=!0}setEvents(t){}fillRect(t,e,i,s,a){this.configuration.canvasElement2DContext.fillStyle=a,this.configuration.canvasElement2DContext.fillRect(t,e,i,s)}clear(t){this.fillRect(0,0,this.configuration.canvasWidth,this.configuration.canvasHeight,t)}blit(t,e,i){this.configuration.canvasElement2DContext.drawImage(i.imageObject,t,e)}print(t,e,i,s){this.configuration.canvasElement2DContext.fillStyle=s,this.configuration.canvasElement2DContext.fillText(i,t,e)}}e.default=n},923:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.initialized=!1,this.configuration=t}initialize(t){this.setEvents(t)}setEvents(t){}}},327:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=s(i(923));class n extends a.default{setEvents(t){t.requestAnimationFrame((()=>this.doRender()))}requestFrame(t){this.requestFrameFunction=t,this.setEvents(this.configuration.window)}doRender(){this.requestFrameFunction&&this.requestFrameFunction(),window.requestAnimationFrame((()=>this.doRender()))}}e.default=n},492:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=s(i(909)),n=new(s(i(468)).default)("#canvas",window),o=new a.default(n);o.initialize(),n.initialize();const r=n.draw.configuration.htmlCanvasElement;if(!r)throw new Error("Canvas Element (#canvas) does not exist.");var l=r.offsetLeft,u=r.offsetTop;document.querySelectorAll(".tool-changer").forEach((t=>{t.addEventListener("click",(t=>{var e=t.target;o.changeTool(parseInt(e.getAttribute("data-tool")))}))})),n.loop.requestFrame((()=>{o.drawMap();const t={x:n.controls.mouseState.clientX-l,y:n.controls.mouseState.clientY-u};n.controls.mouseState.mouseDown&&(o.addParticle(t.x,t.y,0),o.addParticle(t.x+1,t.y,0),o.addParticle(t.x+1,t.y+1,0),o.addParticle(t.x-1,t.y-1,0),o.addParticle(t.x,t.y+1,0))}))},909:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=s(i(862)),n=s(i(791)),o=s(i(150)),r=s(i(485)),l=s(i(428));e.default=class{constructor(t){this.map=new a.default,this.TILE_SIZE=10,this.currentTool=1,this.tools=[0,1,2,3,4,5,6],this.calcTimer=()=>{},this.initialize=()=>{setInterval(this.calcTimer,100)},this.addParticle=(t,e,i)=>{this.map.addParticle(Math.round(t/this.TILE_SIZE),Math.round(e/this.TILE_SIZE),this.createParticleOfTool(this.currentTool))},this.drawMap=()=>{var t;null===(t=this.context2D)||void 0===t||t.draw.clear("black"),this.map.forEachParticle(((t,e,i)=>{i&&(i.calculatedInCycle=!1)})),this.map.forEachParticle(this.drawParticle),this.map.calc()},this.drawParticle=(t,e,i)=>{if(!this.context2D)throw new Error("context2D should be set");this.context2D.draw.fillRect(t*this.TILE_SIZE,e*this.TILE_SIZE,this.TILE_SIZE,this.TILE_SIZE,i.primaryColor)},this.context2D=t}create(t){return new t}createParticleOfTool(t){switch(t){case 0:case 1:return new n.default;case 2:return new o.default;case 3:return new r.default;case 4:return new l.default;default:return new n.default}}changeTool(t){this.currentTool=t,console.log("change tool to",t)}}},324:(t,e)=>{var i,s;Object.defineProperty(e,"__esModule",{value:!0}),e.DIRECTION=e.AGGREGATESTATE=void 0,function(t){t[t.SOLID=0]="SOLID",t[t.LIQUID=1]="LIQUID",t[t.GASEOUS=2]="GASEOUS"}(i=e.AGGREGATESTATE||(e.AGGREGATESTATE={})),function(t){t[t.UP=0]="UP",t[t.UPRIGHT=1]="UPRIGHT",t[t.RIGHT=2]="RIGHT",t[t.RIGHTDOWN=3]="RIGHTDOWN",t[t.DOWN=4]="DOWN",t[t.DOWNLEFT=5]="DOWNLEFT",t[t.LEFT=6]="LEFT",t[t.LEFTUP=7]="LEFTUP"}(s=e.DIRECTION||(e.DIRECTION={})),e.default=class{constructor(){this.name="unknown",this.calculatedInCycle=!1,this.colors=["white"],this.primaryColor="",this.density=1,this.temperature=20,this.weight=100,this.acceleration=0,this.aggregateState=i.SOLID,this.conductivity=50,this.heatCapacity=.9,this.angle=0,this.initialize=()=>{let t=Math.round(Math.random()*this.colors.length);this.primaryColor=this.colors[t]},this.calc=t=>{this.calculatedInCycle||(this.move(t.moveParticle),this.outerCircumstancesPerCycle(),this.calculatedInCycle=!0)},this.collision=t=>{t.temperature>this.temperature?this.temperature+=t.temperature/this.heatCapacity:t.temperature<this.temperature&&(this.temperature-=t.temperature/this.heatCapacity)},this.move=t=>{var e,a,n,o,r,l,u,h,c,d,f,v,p,g,b,E,m,y,_,S,w,T,O,P,I,D;if(this.aggregateState===i.GASEOUS)t(this,s.UP);else if(this.aggregateState===i.SOLID)this.weight>0&&(null===(a=null===(e=this.parentMapState)||void 0===e?void 0:e.neighbours)||void 0===a?void 0:a.below)&&(null===(r=null===(o=null===(n=this.parentMapState)||void 0===n?void 0:n.neighbours)||void 0===o?void 0:o.below)||void 0===r?void 0:r.density)<this.density?t(this,s.DOWN):this.weight<0&&t(this,s.UP);else if(this.aggregateState===i.LIQUID){if((null===(l=this.parentMapState)||void 0===l?void 0:l.density)>this.density&&0==(null===(c=null===(h=null===(u=this.parentMapState)||void 0===u?void 0:u.neighbours)||void 0===h?void 0:h.above)||void 0===c?void 0:c.density))return void t(this,s.UP);this.weight>0&&(null===(f=null===(d=this.parentMapState)||void 0===d?void 0:d.neighbours)||void 0===f?void 0:f.below)&&(null===(g=null===(p=null===(v=this.parentMapState)||void 0===v?void 0:v.neighbours)||void 0===p?void 0:p.below)||void 0===g?void 0:g.density)<=this.density/2?t(this,s.DOWN):(null===(m=null===(E=null===(b=this.parentMapState)||void 0===b?void 0:b.neighbours)||void 0===E?void 0:E.below)||void 0===m?void 0:m.density)>=this.density/2&&(null===(S=null===(_=null===(y=this.parentMapState)||void 0===y?void 0:y.neighbours)||void 0===_?void 0:_.left)||void 0===S?void 0:S.density)<=this.density&&(1==Math.floor(3*Math.random())&&0==(null===(O=null===(T=null===(w=this.parentMapState)||void 0===w?void 0:w.neighbours)||void 0===T?void 0:T.left)||void 0===O?void 0:O.density)?t(this,s.LEFT):0==(null===(D=null===(I=null===(P=this.parentMapState)||void 0===P?void 0:P.neighbours)||void 0===I?void 0:I.right)||void 0===D?void 0:D.density)&&t(this,s.RIGHT))}},this.outerCircumstancesPerCycle=()=>{},this.initialize()}}},862:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(324),n=s(i(576)),o=s(i(522));e.default=class{constructor(){this.dataSource=[[]],this.width=120,this.height=60,this.physics={temperature:20,gravity:0,windDirection:a.DIRECTION.RIGHT},this.generate=()=>{for(var t=0;t<this.height;t++){this.dataSource[t]=[];for(var e=0;e<this.width;e++)this.dataSource[t][e]=new n.default,0!=t&&0!=e&&e!=this.width-1&&t!=this.height-1||this.dataSource[t][e].particles.push(new o.default)}this.setNeigbours()},this.setNeigbours=()=>{for(var t=0;t<this.height;t++)for(var e=0;e<this.width;e++)this.dataSource[t][e].neighbours={above:t>0?this.dataSource[t-1][e]:void 0,below:t<this.height-1?this.dataSource[t+1][e]:void 0,right:e>0?this.dataSource[t][e+1]:void 0,left:e<this.width-1?this.dataSource[t][e-1]:void 0}},this.forEachParticleMapState=t=>{for(var e=this.height-1;e>0;e--)for(var i=0;i<this.width-1;i++)t(this.dataSource[e][i])},this.forEachParticle=t=>{for(var e=0;e<this.height;e++)for(var i=0;i<this.width;i++)for(var s in this.dataSource[e][i].particles)t(i,e,this.dataSource[e][i].particles[s])},this.calc=()=>{this.forEachParticleMapState((t=>{t.calc()}))},this.generate()}addParticle(t,e,i){t>=0&&t<=this.width&&e>=0&&e<=this.height&&(i.parentMapState=this.dataSource[e][t],this.dataSource[e][t].particles.push(i))}createParticle(){}}},576:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=i(324);e.default=class{constructor(){this.particles=[],this.calc=()=>{for(const t in this.particles){const e=this.particles[t];new Promise(((t,i)=>{e&&e.calc(this),t(!0)}))}},this.moveParticle=(t,e)=>{var i,a,n,o,r,l,u,h,c,d,f,v,p,g,b,E;this.particles.indexOf(t),this.particles=[],(null===(i=this.neighbours)||void 0===i?void 0:i.below)&&(null===(a=this.neighbours)||void 0===a?void 0:a.below.particles.length)>0&&(null===(n=this.neighbours)||void 0===n||n.below.particles[0].collision(t)),(null===(o=this.neighbours)||void 0===o?void 0:o.above)&&(null===(r=this.neighbours)||void 0===r?void 0:r.above.particles.length)>0&&(null===(l=this.neighbours)||void 0===l||l.above.particles[0].collision(t)),(null===(u=this.neighbours)||void 0===u?void 0:u.left)&&(null===(h=this.neighbours)||void 0===h?void 0:h.left.particles.length)>0&&(null===(c=this.neighbours)||void 0===c||c.left.particles[0].collision(t)),(null===(d=this.neighbours)||void 0===d?void 0:d.right)&&(null===(f=this.neighbours)||void 0===f?void 0:f.right.particles.length)>0&&(null===(v=this.neighbours)||void 0===v||v.right.particles[0].collision(t)),e==s.DIRECTION.DOWN?(null===(p=this.neighbours)||void 0===p?void 0:p.below)?(this.neighbours.below.particles.push(t),t.parentMapState=this.neighbours.below):this.particles.push(t):e==s.DIRECTION.UP?(null===(g=this.neighbours)||void 0===g?void 0:g.above)?(this.neighbours.above.particles.push(t),t.parentMapState=this.neighbours.above):this.particles.push(t):e==s.DIRECTION.LEFT?(null===(b=this.neighbours)||void 0===b?void 0:b.left)?(this.neighbours.left.particles.push(t),t.parentMapState=this.neighbours.left):this.particles.push(t):e==s.DIRECTION.RIGHT&&((null===(E=this.neighbours)||void 0===E?void 0:E.right)?(this.neighbours.right.particles.push(t),t.parentMapState=this.neighbours.right):this.particles.push(t))}}get density(){var t=0;for(const e in this.particles)t+=this.particles[e].density;return t}calcCollisions(){for(const t in this.particles)for(const e in this.particles)e!=t&&this.particles[t].collision(this.particles[e])}}},485:function(t,e,i){var s=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&s(e,t,i);return a(e,t),e},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const r=n(i(324)),l=o(i(150));class u extends r.default{constructor(){super(),this.name="lava",this.colors=["#ff2500","#ff6600","#f2f217","#f2f217","#ea5c0f"],this.density=1,this.conductivity=130,this.temperature=1e3,this.heatCapacity=.9,this.aggregateState=r.AGGREGATESTATE.LIQUID,this.collision=t=>{var e,i,s;if("water"==t.name){let t=new l.default;null===(e=this.parentMapState)||void 0===e||e.particles.push(t);let a=null===(i=this.parentMapState)||void 0===i?void 0:i.particles.indexOf(this);null===(s=this.parentMapState)||void 0===s||s.particles.slice(a)}},this.initialize()}}e.default=u},150:function(t,e,i){var s=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&s(e,t,i);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});const o=n(i(324));class r extends o.default{constructor(){super(),this.name="stone",this.colors=["rgba(100,100,90)","rgba(90,90,90)","rgba(100,100,100)"],this.density=10,this.conductivity=130,this.heatCapacity=.9,this.aggregateState=o.AGGREGATESTATE.SOLID,this.initialize()}}e.default=r},791:function(t,e,i){var s=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&s(e,t,i);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});const o=n(i(324));class r extends o.default{constructor(){super(),this.name="water",this.colors=["#0f5e9c","#2389da","#1ca3ec","#5abcd8"],this.density=1,this.conductivity=130,this.heatCapacity=.9,this.aggregateState=o.AGGREGATESTATE.LIQUID,this.outerCircumstancesPerCycle=()=>{this.aggregateState===o.AGGREGATESTATE.GASEOUS&&(this.weight=-1),this.temperature>100?(this.aggregateState=o.AGGREGATESTATE.GASEOUS,this.primaryColor="rgba(255,255,255,0.5)"):this.temperature<100?this.aggregateState=o.AGGREGATESTATE.LIQUID:this.temperature<0&&(this.aggregateState=o.AGGREGATESTATE.SOLID)},this.initialize()}}e.default=r},522:function(t,e,i){var s=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&s(e,t,i);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});const o=n(i(324));class r extends o.default{constructor(){super(),this.name="worldBorder",this.colors=["rgba(100,100,90)","rgba(90,90,90)","rgba(100,100,100)"],this.density=10,this.conductivity=130,this.weight=0,this.heatCapacity=.9,this.aggregateState=o.AGGREGATESTATE.SOLID,this.initialize()}}e.default=r},428:function(t,e,i){var s=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i),Object.defineProperty(t,s,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&s(e,t,i);return a(e,t),e};Object.defineProperty(e,"__esModule",{value:!0});const o=n(i(324));class r extends o.default{constructor(){super(),this.name="grass",this.colors=["#136d15","#117c13","#138510"],this.density=2,this.conductivity=130,this.heatCapacity=.9,this.aggregateState=o.AGGREGATESTATE.SOLID,this.initialize()}}e.default=r}},e={};return function i(s){if(e[s])return e[s].exports;var a=e[s]={exports:{}};return t[s].call(a.exports,a,a.exports,i),a.exports}(492)})().default;